<!DOCTYPE html>
<html>
  <head>
    <title>Resumen de Stripes</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta content=', stripes, wdt, web, java, maven' name='keywords'>
    <meta content='Resumen de Desarrollo Web (Stripes)' name='description'>
    <link href='/assets/css/reset.css' rel='stylesheet' type='text/css'>
    <link href='/assets/css/style.css' media='screen' rel='stylesheet' type='text/css'>
  </head>
  <body>
    <div id='main'>
      <div id='header'>
        <div class='logo'>
          <a href='/'>&laquo; Miguel Triana - site</a>
        </div>
        <div id='nav'>
          <ul>
            <li><a href='/archives.html'>archives</a></li>
            <li><a href='/tags.html'>tags</a></li>
            <li><a href='/projects.html'>projects</a></li>
            <li><a href='/about.html'>about</a></li>
            <li><a href='/contact.html'>contact</a></li>
            <li>
              <a href='/atom.xml'>rss</a>
            </li>
          </ul>
        </div>
      </div>
      <div class='clear'></div>
      <div id='content'>
        <div class='article'>
          <h1>
            Resumen de Stripes
          </h1>
          <div class='meta'>
            <ul class='tags'>
              <li>Mar 18, 2012</li>
              <li>
                &middot;
              </li>
              <li>
                <a href='/2012/03/18/stripes_summary.html#disqus_thread'></a>
              </li>
              <li>&middot;</li>
              <li>
                <a class='tag' href='/tags/java/'>
                  java
                </a>
              </li>
              <li>
                <a class='tag' href='/tags/maven/'>
                  maven
                </a>
              </li>
              <li>
                <a class='tag' href='/tags/stripes/'>
                  stripes
                </a>
              </li>
              <li>
                <a class='tag' href='/tags/wdt/'>
                  wdt
                </a>
              </li>
              <li>
                <a class='tag' href='/tags/web/'>
                  web
                </a>
              </li>
            </ul>
          </div>
          <div class='body'>
            <p>Este es un resumen del material para desarrollo de aplicaciones web usando Stripes. Este resumen esta basado en el libro <a href="http://pragprog.com/book/fdstr/stripes" target="_blank"><em>Stripes ...and Java Web Development Is Fun Again</em></a>.</p>
            
            <p>Durante el resumen, va a ser implementado un administrador de tareas (ToDo list).</p>
            
            <p>Son utilizadas las siguientes herramientas:</p>
            
            <ul>
            <li>Maven 2: Sistema de construcción y administrador de dependencias</li>
            <li>Stripes: Framework para desarrollo de aplicaciones Web usando MVC (Model-View-Controller)</li>
            <li>Eclipse: IDE</li>
            <li>JDK: Entorno de Desarrollo de Java</li>
            <li>Git: Control de versiones</li>
            </ul>
            
            
            <p><strong>Nota:</strong> Se asume que el lector ya ha instalado maven, eclipse, java y git.</p>
            
            <p><strong>Sources</strong>: Todo el código esta disponible en <a href="https://github.com/emiguelt/ToDo-s" target="_blank">GitHub</a></p>
            
            <h1>Stripes</h1>
            
            <p>Stripes es un framework MVC para el desarrollo de aplicaciones Web para Java.</p>
            
            <h3>Configuración de Stripes</h3>
            
            <p><strong><em>Tag en Git: WDT-P01</em></strong>:  Implementa un CRUD básico para el administrador de tareas de ejemplo</p>
            
            <p>Para integrar Stripes en una aplicación web es necesario modificar el archivo <em>web.xml</em> con la siguiente información:</p>
            
            <ul>
            <li>Declaración del filtro de Stripes: <code>net.sourceforge.stripes.controller.StripesFilter</code>.</li>
            <li>Establecer en que paquete se encuentran los <em>ActionBeans</em> (<code>ActionResolver.Packages</code>).</li>
            <li>Declaración de <code>net.sourceforge.stripes.controller.DispatcherServlet</code>.</li>
            <li>Configuración del filtro para interceptar todos los requests que van atraves del dispatcher.</li>
            <li>Mapeamento del patrón de las URLs para ser capturadas por Stripes (Ej: .action)</li>
            </ul>
            
            
            <h3>ActionBeans</h3>
            
            <p>Un <em>ActionBean</em> es una clase que implementa la interfaz <em>ActionBean</em>, esta clase define los métodos (eventos, <em>event handler</em>) disponibles para procesamiento de los requerimientos (requests) de los usuarios.</p>
            
            <pre><code>public interface ActionBean {&#x000A;  public void setContext(ActionBeanContext context);&#x000A;  public ActionBeanContext getContext();&#x000A;}&#x000A;</code></pre>
            
            <h3>Event Handlers</h3>
            
            <p>Un <em>Event Handler</em> es un método que captura un request de un usuario. Dentro del <em>Action Bean</em>, es un método público, sin parámetros y que retorna un objeto <em>Resolution</em>.
            Por ejemplo, en la clase TaskAction está el método <em>delete</em>, que es invocado para borrar un registro en la lista de tareas</p>
            
            <pre><code>public class TaskAction extends BaseAction {&#x000A;...&#x000A;  public Resolution delete() {&#x000A;          getTaskDao().delete(getTaskId());&#x000A;          return redirectToTaskList();&#x000A;      } &#x000A;...&#x000A;}&#x000A;</code></pre>
            
            <p>El cual podría ser llamado desde el browser asi: <code>http://localhost:8080/todos/Task.action?event=delete&amp;taskId=10</code></p>
            
            <p><strong>Nota:</strong> Todos los <em>ActionBeans</em> deben tener un método predeterminado que debe ser marcado con <code>@DefaultHandler</code></p>
            
            <h3>Resolutions</h3>
            
            <p>Un objeto <em>Resolution</em> es una "respuesta" para Stripes, indicando cual es el siguiente paso de procesamiento del request. Resolutions pueden ser: ForwardResolution, RedirectResolution, StreamingResolution, JavaScriptResolution, ErrorResolution o cualquier otra que implemente la interfaz:</p>
            
            <pre><code>public interface Resolution {&#x000A;  void execute(HttpServletRequest request, HttpServletResponse response)&#x000A;  throws Exception;&#x000A;}&#x000A;</code></pre>
            
            <h3>Referenciando un ActionBean desde JSP</h3>
            
            <p>Un método o atributo de un ActionBean puede ser invocado desde una página JSP usando <em>Expression Language</em> con la palabra clave <em>actionBean</em>, por ejemplo, la expresión <code>${actionBean.task.id}</code> obtiene el ID de una tarea a partir del ActionBean activo.</p>
            
            <h3>Preaction Pattern</h3>
            
            <p>Este patrón recomienda que todos los request en una aplicación web sean hechos a los <em>ActionBeans</em>  y NO directamente a las JSPs, de esta forma se garantiza que todos los JSPs van a tener un <em>actionBean</em>, es posible interceptar el ciclo de vida request-response de Stripes y se puede tener un mejor control de acceso. Para evitar el acceso directo a los JSPs, estos deben colocarse en la carpeta <em>WEB-INF</em> de la aplicación.</p>
            
            <h2>Validación</h2>
            
            <p><strong>Tag en Git: WDT-P02</strong>: Fueron adicionadas validaciones básicas en la edición de tareas.</p>
            
            <p>Para realizar validaciones de formularios se hace uso de <em>Anotaciones</em> en los <em>ActionBeans</em>. Sintaxis básica:</p>
            
            <ul>
            <li><em>@Validate(required=true, OTRAS RESTRICCIONES)</em>: esta anotación se coloca en el atributo o método que se quiere validar</li>
            <li><em>@ValidateNestedProperties({@Validate(field=xxx, Restricción),...)</em>: Anotación para realizar validaciones en atributos de objetos en el <em>ActionBean</em>, por ejemplo <em>Persona.edad</em></li>
            <li><em>@Validate(expression=${REGEX})</em>: Permite validación con expresiones regulares</li>
            <li><em>@DontValidate</em>: Anotación para evitar la validación en un evento (Event handler)</li>
            <li><em>@Validate(on="handler")</em>: Restringe la validación al método referenciado en el parámetro <em>on</em>.</li>
            <li><em>@ValidationMethod(on={handlers})</em>: Anota un método como validador para uno o mas <em>handlers</em>. El método debe ser publico y debe recibir <em>ValidationErrors</em> o ningún parametro.</li>
            <li>Interceptar Errores de Validación. Si el <em>ActionBean</em> implementa la <em>Interface ValidationErrorHandler</em> es posible interceptar la validación de errores, para eliminar, adicionar o modificar errores</li>
            </ul>
            
            
            <h2>Data types</h2>
            
            <ul>
            <li>De String a <T> : <strong>Conversión</strong> de una cadena de caracteres a objeto T.</li>
            <li>De <T> a String: <strong>Formato</strong> de un objeto T a cadena de caracteres.</li>
            </ul>
            
            
            <h3>Conversión</h3>
            
            <p>Un <em>Conversor</em> en Stripes implementa la interfaz <em>TypeConverter<T></em></p>
            
            <h4>Conversores propios de Stripes:</h4>
            
            <ul>
            <li>Conversión de tipos primitivos y <em>wrappers</em>. Ej. String -> Integer : "1" -> Integer(1)</li>
            <li>java.util.Date: Stripes usa DateFormat de Java para realizar conversión de fechas, realizando primero un preprocesamiento donde los separadores, como <code>/</code> o <code>-</code>, son reemplazados por espacios en blanco, entre otros procedimientos, para obtener un String dentro de los formatos de Java. También es posible configurar un o mas patron propio colocandolo en el archivo StripesResources.properties, usando la clave <code>stripes.dateTypeCoverter.formatString=yyyy MM d, otros...</code></li>
            <li>Tipos <em>Enumerated</em>: Stripes soporta conversión automática de tipos <em>Enumerated</em>. Es case-sensitive</li>
            <li><em>Booleans</em>: Stripes acepta como verdadero las siguientes cadenas: <em>true, t, yes, y, on, 1</em>, el resto es considerado como falso.</li>
            <li>Single Caracteres: "Hello" -> "H"</li>
            <li>Otros: <em>EmailTypeConverter, CreditCardConverter, PercentageTypeConverter, OneToManyTypeConverter</em></li>
            </ul>
            
            
            <p>Para usar un conversor específico,  el atributo debe ser anotado con <code>@Validate(converter=ElConversorEspecifico.class)</code>.</p>
            
            <h3>Formato</h3>
            
            <p>Un <em>Formateador</em> en Stripes implementa la interfaz <em>Formatter<T></em></p>
            
            <h4>Formateadores propios de Stripes</h4>
            
            <ul>
            <li>Dates: SimpleDateFormta + Locale</li>
            <li>Número: DecimalFormt + Locale</li>
            <li>Enumerated: Enum.name()</li>
            <li>Objects: obj.toString()</li>
            </ul>
            
            
            <p><em>Formatters</em> son usados en tags que aceptan atributos <em>formatType</em> y <em>formatPattern</em> como <code>&lt;s:format&gt; y &lt;s:text&gt;</code></p>
            
            <p><strong>Nota:</strong> Converters, formatters y componentes adicionales de Stripes pueden ser utilizados configurando en el web.xml, configurando el parámetro <em>Extension.Packages</em> en el <em>StripesFilter</em>.</p>
          </div>
        </div>
        <div id='other-articles'>
          <div class='older'>
            <ul>
              <li>
                <h3>
                  <a href='/tips/cmds.html' title='Commands reference for develoment with Maven, Git, Ant, SVN, CVS, VirtualBox, etc.'>
                    &laquo; Commands summary
                  </a>
                </h3>
              </li>
              <li>
                <h3>
                  <a href='/2011/10/21/cassandra_hector.html' title='Uso de la biblioteca Hector para accesar Cassandra'>
                    &laquo; Cassandra y Hector
                  </a>
                </h3>
              </li>
              <li>
                <h3>
                  <a href='/2011/10/21/cassandra_cli.html' title='Comandos básicos para el cliente (consola) de Cassandra'>
                    &laquo; Usando Cassandra_CLI (Básico)
                  </a>
                </h3>
              </li>
            </ul>
          </div>
          <div class='newer'>
            <ul>
              <li>
                <h3>
                  <a href='/2012/04/08/spring_summary.html' title='Resumen del Framework Spring'>
                    Resumen Spring &raquo;
                  </a>
                </h3>
              </li>
              <li>
                <h3>
                  <a href='/2012/05/20_Spring_summary_p2.html' title='Resumen del Framework Spring - Segunda parte'>
                    Resumen Spring - Parte 2 &raquo;
                  </a>
                </h3>
              </li>
              <li>
                <h3>
                  <a href='/2013/11/30_jade_backbone.html' title='This is an example of Jade (runtime) integration with Backbone.js with RequireJS'>
                    Jade, Backbone.js and Require.js, a running example &raquo;
                  </a>
                </h3>
              </li>
            </ul>
          </div>
        </div>
        <div class='clear'></div>
        <div class='comments'>
          <div id='disqus_thread'></div>
          <script src='http://disqus.com/forums/emiguelwebpage/embed.js' type='text/javascript'></script>
          <noscript>
            <a href='http://disqus.com/forums/emiguelwebpage/?url=ref'>
              View the discussion thread
            </a>
          </noscript>
        </div>
        <!-- / disqus adds too much visual crap -->
        <style type='text/css'>
          <style>
            .dsq-dc-logo {
              display: none !important; }
          </style>
        </style>
      </div>
      <div class='clear'></div>
    </div>
    <script>
      (function() {
        var links = document.getElementsByTagName('a');
        var query = '?';
        for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
            query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
        }
        document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/emiguelwebpage/get_num_replies.js' + query + '"></' + 'script>');
      })();
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-46201600-1', 'leugim.co)';
      ga('send', 'pageview');
    </script>
  </body>
</html>
